{% extends "layout.html" %}
{% block title %}Login - Suraksha AI{% endblock %}
{% block content %}
<div class="container my-5" style="max-width:640px;">

  <div class="text-center mb-4">
    <span class="badge bg-light text-dark">Welcome back</span>
    <h2 class="mt-2 mb-1">Sign in to Suraksha AI</h2>
    <p class="text-muted mb-0">Continue where you left off â€” dashboards, charts and predictions.</p>
  </div>

  <div class="card hover-lift">
    <div class="card-header d-flex align-items-center justify-content-between">
      <h4 class="mb-0">Login</h4>
      <span class="badge badge-soft">Dev Mode: LocalStorage</span>
    </div>
    <div class="card-body">
      <form id="loginForm" novalidate>
        <!-- Email -->
        <div class="mb-3">
          <label class="form-label">Email</label>
          <div class="input-group">
            <span class="input-group-text">ðŸ“§</span>
            <input class="form-control" id="loginEmail" type="email" placeholder="you@example.com" autocomplete="email" required>
          </div>
        </div>

        <!-- Password -->
        <div class="mb-2">
          <label class="form-label">Password</label>
          <div class="input-group">
            <span class="input-group-text">ðŸ”’</span>
            <input class="form-control" id="loginPassword" type="password" placeholder="Enter your password" autocomplete="current-password" required>
            <button class="btn btn-outline-secondary" id="pwToggle">Show</button>
          </div>
          <small id="capsHint" class="text-warning d-block mt-1" style="display:none;">Caps Lock is ON</small>
        </div>

        <!-- Helpers -->
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="rememberMe" checked>
            <label class="form-check-label" for="rememberMe">Keep me signed in</label>
          </div>
          <a href="#" data-bs-toggle="modal" data-bs-target="#forgotModal">Forgot password?</a>
        </div>

        <button class="btn btn-primary w-100">Login</button>

        <!-- Quick fill for demo/admin -->
        <div class="d-grid gap-2 mt-2">
          <button type="button" class="btn btn-outline-secondary" id="btnAdminDemo">Use Admin Demo (admin@suraksha.com)</button>
        </div>
      </form>

      <div class="mt-3 p-3 rounded-3" style="background:#f7f9ff;">
        <small class="text-muted">
          In dev mode, your session is stored in browser LocalStorage until you log out or clear storage.
        </small>
      </div>

      <p class="text-center mt-3 mb-0">
        No account?
        <a href="{{ url_for('register_page') }}">Register</a>
      </p>
    </div>
  </div>
</div>

<!-- Forgot Password Modal (dev-mode info) -->
<div class="modal fade" id="forgotModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered"><div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Forgot Password</h5>
      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
      <p class="mb-2">This demo uses LocalStorage (no email service). To reset:</p>
      <ul class="mb-2">
        <li>Login with Admin Demo: <code>admin@suraksha.com / admin123</code></li>
        <li>Or clear LocalStorage from Admin â†’ Clear Local Data</li>
      </ul>
      <small class="text-muted">For production, add a real backend with email-based reset.</small>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" data-bs-dismiss="modal">Got it</button>
    </div>
  </div></div>
</div>

<!-- Page helpers: show/hide password, caps-lock, quick fill -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const pwd = document.getElementById('loginPassword');
  const toggle = document.getElementById('pwToggle');
  const caps = document.getElementById('capsHint');
  const email = document.getElementById('loginEmail');
  const btnDemo = document.getElementById('btnAdminDemo');

  // Show/Hide
  toggle.addEventListener('click', (e) => {
    e.preventDefault();
    const type = pwd.getAttribute('type') === 'password' ? 'text' : 'password';
    pwd.setAttribute('type', type);
    toggle.textContent = type === 'password' ? 'Show' : 'Hide';
  });

  // Caps-lock hint
  pwd.addEventListener('keyup', (e) => {
    if (e.getModifierState) caps.style.display = e.getModifierState('CapsLock') ? 'block' : 'none';
  });

  // Quick-fill Admin demo
  btnDemo.addEventListener('click', () => {
    email.value = 'admin@suraksha.com';
    pwd.value = 'admin123';
    pwd.dispatchEvent(new Event('keyup')); // update caps hint
  });
});
</script>
{% endblock %}